<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DartMaster Elite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 100%);
            color: #ffffff;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            height: 90vh;
            background: rgba(20, 20, 20, 0.9);
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: linear-gradient(135deg, #333 0%, #444 100%);
            border-bottom: 1px solid #555;
        }

        header img {
            width: 50px;
            height: 50px;
            object-fit: contain;
        }

        .main-menu, #setup-screen, #game-interface {
            display: none;
            flex: 1;
            flex-direction: column;
            padding: 20px;
            overflow-y: auto;
        }

        .main-games, .party-games {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .party-games-card {
            background: linear-gradient(135deg, #666 0%, #555 100%);
            border: 2px solid #888;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .party-games-card:hover {
            background: linear-gradient(135deg, #777 0%, #666 100%);
            transform: scale(1.05);
        }

        .menu-card {
            background: linear-gradient(135deg, #4a9eff 0%, #2a6eb6 100%);
            border: 2px solid #6ab0ff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .menu-card:hover {
            background: linear-gradient(135deg, #5ab0ff 0%, #2a6eb6 100%);
            transform: scale(1.05);
        }

        h1, h2 {
            text-align: center;
        }

        .setup-options {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .player-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-input input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: #333;
            color: #fff;
        }

        .add-player-btn, .remove-player-btn, .start-game-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: linear-gradient(135deg, #4a9eff 0%, #2a6eb6 100%);
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-player-btn:hover, .remove-player-btn:hover, .start-game-btn:hover {
            background: linear-gradient(135deg, #5ab0ff 0%, #2a6eb6 100%);
        }

        .game-content {
            flex: 1;
            display: flex;
            gap: 20px;
            padding: 20px 0;
        }

        .players-panel, .input-panel {
            flex: 1;
            background: linear-gradient(135deg, #222 0%, #333 100%);
            border-radius: 10px;
            padding: 15px;
            overflow-y: auto;
        }

        .player {
            margin-bottom: 10px;
            padding: 10px;
            background: #2a2a2a;
            border-radius: 5px;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .input-button {
            background: linear-gradient(135deg, #666 0%, #555 100%);
            border: none;
            color: #ffffff;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .input-button:hover {
            background: linear-gradient(135deg, #777 0%, #666 100%);
            transform: scale(1.05);
        }

        .input-button.double, .input-button.triple {
            background: linear-gradient(135deg, #ff6b6b 0%, #d63a3a 100%);
        }

        .input-button.double:hover, .input-button.triple:hover {
            background: linear-gradient(135deg, #ff8787 0%, #d63a3a 100%);
        }

        .button-main {
            font-size: 18px;
            font-weight: bold;
        }

        .button-sub {
            font-size: 12px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: linear-gradient(135deg, #333 0%, #444 100%);
            border-bottom: 1px solid #555;
        }

        .back-btn {
            background: none;
            border: none;
            color: #fff;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            color: #4a9eff;
            transform: scale(1.2);
        }

        .help-btn {
            background: linear-gradient(135deg, #666 0%, #555 100%);
            border: none;
            color: #ffffff;
            font-size: 24px;
            cursor: pointer;
            padding: 12px 16px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .help-btn:hover {
            background: linear-gradient(135deg, #777 0%, #666 100%);
            transform: scale(1.1);
        }

        #progress-text, #target-display {
            text-align: center;
            margin: 10px 0;
        }

        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .popup-content {
            background: linear-gradient(135deg, #222 0%, #333 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .popup-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: space-around;
        }

        .popup-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background: linear-gradient(135deg, #4a9eff 0%, #2a6eb6 100%);
            color: #fff;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .popup-btn:hover {
            background: linear-gradient(135deg, #5ab0ff 0%, #2a6eb6 100%);
        }

        @media (max-width: 768px) {
            .game-content {
                flex-direction: column;
            }
            
            .players-panel {
                width: 100%;
                max-height: 40vh;
            }
            
            .input-panel {
                width: 100%;
            }
            
            .main-games {
                grid-template-columns: 1fr;
            }
            
            .party-games {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            }
            
            .input-button {
                min-height: 60px;
                font-size: 14px;
                padding: 5px;
            }
            
            .input-grid.x01-grid {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: auto;
                gap: 4px;
            }
            
            .button-main {
                font-size: 14px;
            }
            
            .button-sub {
                font-size: 10px;
            }
            
            .player-input input {
                padding: 10px;
                font-size: 12px;
            }
            
            .add-player-btn, .remove-player-btn {
                padding: 8px 12px;
                font-size: 12px;
            }
            
            .start-game-btn {
                padding: 15px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <img src="jamie-tech-prints-logo.png" 
                 alt="Jamie Tech Prints Logo" 
                 style="width: 50px; height: 50px; object-fit: contain;" 
                 onerror="this.src='https://via.placeholder.com/50?text=Logo'; this.onerror=null;">
            <h1>DartMaster Elite</h1>
            <div></div>
        </header>
        <div class="main-menu">
            <h2>Select a Game</h2>
            <div class="main-games">
                <div class="menu-card" onclick="setupGame('x01')" aria-label="Start X01 game">
                    <h2>X01</h2>
                </div>
                <div class="menu-card" onclick="setupGame('cricket')" aria-label="Start Cricket game">
                    <h2>Cricket</h2>
                </div>
            </div>
            <div class="party-games-card" onclick="togglePartyGames()" aria-label="Show party games">
                <h2>Party games</h2>
            </div>
            <div id="party-games-grid" class="party-games">
                <div class="menu-card" onclick="setupGame('shooter')" aria-label="Start Shooter game">
                    <h2>Shooter</h2>
                </div>
                <div class="menu-card" onclick="setupGame('shanghai')" aria-label="Start Shanghai game">
                    <h2>Shanghai</h2>
                </div>
                <div class="menu-card" onclick="setupGame('clock')" aria-label="Start Around the Clock game">
                    <h2>Around the Clock</h2>
                </div>
                <div class="menu-card" onclick="setupGame('120')" aria-label="Start 1-20 Random game">
                    <h2>1-20 Random</h2>
                </div>
                <div class="menu-card" onclick="setupGame('split')" aria-label="Start Split Score game">
                    <h2>Split Score</h2>
                </div>
                <div class="menu-card" onclick="setupGame('killer')" aria-label="Start Killer game">
                    <h2>Killer</h2>
                </div>
                <div class="menu-card" onclick="setupGame('golf')" aria-label="Start Golf game">
                    <h2>Golf</h2>
                </div>
                <div class="menu-card" onclick="setupGame('baseball')" aria-label="Start Baseball game">
                    <h2>Baseball</h2>
                </div>
                <div class="menu-card" onclick="setupGame('elimination')" aria-label="Start Elimination game">
                    <h2>Elimination</h2>
                </div>
                <div class="menu-card" onclick="setupGame('highscore')" aria-label="Start Highscore game">
                    <h2>Highscore</h2>
                </div>
            </div>
        </div>
        <div id="setup-screen">
            <h2 id="setup-title">Setup Game</h2>
            <div class="setup-options">
                <label>
                    <input type="checkbox" id="single-player-toggle" onchange="toggleSinglePlayer()">
                    Single Player Mode
                </label>
                <div class="player-input" style="display: flex;">
                    <input type="text" placeholder="Player 1">
                    <button class="add-player-btn" onclick="addPlayer()">+</button>
                </div>
                <div id="player-inputs"></div>
                <div id="game-options"></div>
                <button class="start-game-btn" onclick="startGame()">Start Game!</button>
            </div>
        </div>
        <div id="game-interface">
            <div class="game-header">
                <button class="back-btn" onclick="forceExit()" id="game-back-btn" aria-label="Return to main menu">←</button>
                <div class="game-title" id="game-title">Game</div>
                <button class="help-btn" onclick="showGameRules()" aria-label="Show game rules">?</button>
            </div>
            <div class="game-content">
                <div class="players-panel">
                    <div id="players"></div>
                </div>
                <div class="input-panel">
                    <div id="progress-text"></div>
                    <div id="target-display"></div>
                    <div id="input-grid" class="input-grid"></div>
                </div>
            </div>
        </div>
        <div id="winner-popup" class="popup">
            <div class="popup-content">
                <h2>Winner!</h2>
                <p id="winner-name"></p>
                <p id="win-type"></p>
                <div id="game-stats"></div>
                <div class="popup-buttons">
                    <button class="popup-btn" onclick="playAgain()">Play Again</button>
                    <button class="popup-btn" onclick="confirmExit()">Main Menu</button>
                </div>
            </div>
        </div>
        <div id="exit-popup" class="popup">
            <div class="popup-content">
                <h2>Exit Game?</h2>
                <p>Are you sure you want to abandon this game?</p>
                <div class="popup-buttons">
                    <button class="popup-btn" onclick="confirmExit()">Yes</button>
                    <button class="popup-btn" onclick="cancelExit()">No</button>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Game State and Constants
        var gameState = {
            type: '',
            options: {},
            players: [],
            currentPlayer: 0,
            currentDart: 1,
            currentRound: 1,
            gameActive: false,
            currentTarget: 1,
            targets: [],
            hasHitTarget: false
        };

        var actionHistory = [];

        var partyGamesVisible = false;

        var gameInfo = {
            'x01': { name: 'X01', desc: 'Classic darts game where you aim to reach zero from a starting score.' },
            'cricket': { name: 'Cricket', desc: 'Score points by hitting numbers 15-20 and the bullseye three times each.' },
            'shooter': { name: 'Shooter', desc: 'Hit targets in order to score points.' },
            'shanghai': { name: 'Shanghai', desc: 'Hit single, double, and triple of the same number in one turn.' },
            'clock': { name: 'Around the Clock', desc: 'Hit numbers 1-20 (and optionally bull) in order.' },
            '120': { name: '1-20 Random', desc: 'Hit numbers 1-20 in a random order.' },
            'split': { name: 'Split Score', desc: 'Add up your score with each dart.' },
            'killer': { name: 'Killer', desc: 'Each player gets a number; hit others\' to eliminate them.' },
            'golf': { name: 'Golf', desc: 'Play holes with lowest score winning.' },
            'baseball': { name: 'Baseball', desc: 'Score runs over innings.' },
            'elimination': { name: 'Elimination', desc: 'Lowest scorer per round is eliminated.' },
            'highscore': { name: 'Highscore', desc: 'Highest score with a set number of darts wins.' }
        };

        var x01Mode = 'single';
        var splitMode = 'single';
        var singlePlayerMode = false;

        // UI Functions
        function showMainMenu() {
            document.getElementById('main-menu').style.display = 'flex';
            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('game-interface').style.display = 'none';
            document.getElementById('winner-popup').style.display = 'none';
            document.getElementById('exit-popup').style.display = 'none';
            document.getElementById('party-games-grid').style.display = partyGamesVisible ? 'grid' : 'none';
        }

        function togglePartyGames() {
            partyGamesVisible = !partyGamesVisible;
            document.getElementById('party-games-grid').style.display = partyGamesVisible ? 'grid' : 'none';
        }

        function setupGame(type) {
            gameState.type = type;
            document.getElementById('setup-title').textContent = 'Setup ' + gameInfo[type].name;
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('setup-screen').style.display = 'flex';
            document.getElementById('game-options').innerHTML = '';

            var options = document.createElement('div');
            if (type === 'x01') {
                options.innerHTML = `
                    <label>Starting Score: <input type="number" id="x01-score" value="501" min="101" max="1001" step="1"></label>
                    <label>Start: <select id="x01-start">
                        <option value="single">Single</option>
                        <option value="double">Double</option>
                        <option value="master">Master</option>
                    </select></label>
                    <label>Finish: <select id="x01-finish">
                        <option value="single">Single</option>
                        <option value="double">Double</option>
                        <option value="master">Master</option>
                    </select></label>
                `;
            } else if (type === 'shooter') {
                options.innerHTML = `
                    <label>Rounds: <input type="number" id="shooter-rounds" value="5" min="1" max="20" step="1"></label>
                    <label><input type="checkbox" id="shooter-bull" onchange="toggleShooterBull()"> Include Bull</label>
                    <label><input type="checkbox" id="shooter-half" onchange="toggleShooterHalf()"> Half Score on Miss</label>
                `;
            } else if (type === 'shanghai') {
                options.innerHTML = `
                    <label>Start Number: <input type="number" id="shanghai-start" value="1" min="1" max="20" step="1"></label>
                    <label>End Number: <input type="number" id="shanghai-end" value="20" min="1" max="20" step="1"></label>
                    <label><input type="checkbox" id="shanghai-half" onchange="toggleShanghaiHalf()"> Half Score on Miss</label>
                `;
            } else if (type === 'clock') {
                options.innerHTML = `
                    <label>Order: <select id="clock-order">
                        <option value="asc">1-20</option>
                        <option value="desc">20-1</option>
                        <option value="random">Random</option>
                    </select></label>
                    <label><input type="checkbox" id="clock-bull" onchange="toggleClockBull()"> Include Bull</label>
                    <label><input type="checkbox" id="clock-quick" onchange="toggleClockQuick()"> Quick Mode</label>
                `;
            } else if (type === '120') {
                options.innerHTML = `
                    <label>Order: <select id="120-order">
                        <option value="asc">1-20</option>
                        <option value="desc">20-1</option>
                        <option value="random">Random</option>
                    </select></label>
                `;
            } else if (type === 'killer') {
                options.innerHTML = `
                    <label><input type="checkbox" id="killer-random" onchange="toggleKillerRandom()"> Random Numbers</label>
                `;
            } else if (type === 'golf') {
                options.innerHTML = `
                    <label>Holes: <input type="number" id="golf-holes" value="9" min="1" max="18" step="1"></label>
                `;
            } else if (type === 'baseball') {
                options.innerHTML = `
                    <label>Innings: <input type="number" id="baseball-innings" value="9" min="1" max="9" step="1"></label>
                `;
            } else if (type === 'elimination') {
                options.innerHTML = `
                    <label>Darts per Round: <input type="number" id="elimination-darts" value="3" min="1" max="9" step="1"></label>
                `;
            } else if (type === 'highscore') {
                options.innerHTML = `
                    <label>Darts: <input type="number" id="highscore-darts" value="30" min="1" max="100" step="1"></label>
                `;
            }

            document.getElementById('game-options').appendChild(options);
            updateRemoveButtons();
        }

        function updateGameInterface() {
            document.getElementById('game-title').textContent = gameInfo[gameState.type].name;
            updatePlayersPanel();
            updateProgressText();
            updateTargetDisplay();
            updateInputGrid();
        }

        function updateProgressText() {
            var text = document.getElementById('progress-text');
            if (gameState.type === 'x01') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'shooter') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Round ${gameState.currentRound} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'shanghai') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Number ${gameState.players[gameState.currentPlayer].currentNumber} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'clock' || gameState.type === '120') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Target ${gameState.players[gameState.currentPlayer].currentTargetIndex + 1} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'cricket') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'split') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'killer') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'golf') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Hole ${gameState.players[gameState.currentPlayer].currentHole} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'baseball') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Inning ${gameState.players[gameState.currentPlayer].currentInning} - Dart ${gameState.currentDart} of 3`;
            } else if (gameState.type === 'elimination') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Dart ${gameState.currentDart} of ${gameState.options.eliminationDarts}`;
            } else if (gameState.type === 'highscore') {
                text.textContent = `Player ${gameState.currentPlayer + 1} - Dart ${gameState.players[gameState.currentPlayer].dartsThrown + 1} of ${gameState.options.highscoreDarts}`;
            }
        }

        function updateTargetDisplay() {
            var display = document.getElementById('target-display');
            if (gameState.type === 'shooter') {
                display.textContent = `Target: ${gameState.currentTarget}`;
            } else if (gameState.type === 'shanghai') {
                display.textContent = `Target: ${gameState.players[gameState.currentPlayer].currentNumber}`;
            } else if (gameState.type === 'clock' || gameState.type === '120') {
                display.textContent = `Target: ${gameState.targets[gameState.players[gameState.currentPlayer].currentTargetIndex]}`;
            } else if (gameState.type === 'killer') {
                display.textContent = `Your Number: ${gameState.players[gameState.currentPlayer].targetNumber}`;
            } else if (gameState.type === 'golf') {
                display.textContent = `Hole: ${gameState.players[gameState.currentPlayer].currentHole} (Par ${gameState.players[gameState.currentPlayer].currentHole})`;
            } else if (gameState.type === 'baseball') {
                display.textContent = `Inning: ${gameState.players[gameState.currentPlayer].currentInning}`;
            } else {
                display.textContent = '';
            }
        }

        function updatePlayersPanel() {
            var playersDiv = document.getElementById('players');
            playersDiv.innerHTML = '';
            gameState.players.forEach(function(player, index) {
                var playerDiv = document.createElement('div');
                playerDiv.className = 'player';
                playerDiv.innerHTML = `<strong>${player.name}</strong><br>Score: ${getPlayerScore(player)}`;
                if (gameState.type === 'cricket') {
                    playerDiv.innerHTML += '<br>Marks: ' + JSON.stringify(player.marks);
                } else if (gameState.type === 'killer') {
                    playerDiv.innerHTML += '<br>Lives: ' + player.lives;
                } else if (gameState.type === 'golf') {
                    playerDiv.innerHTML += '<br>Holes: ' + player.holes.length + '/' + gameState.options.golfHoles;
                } else if (gameState.type === 'baseball') {
                    playerDiv.innerHTML += '<br>Innings: ' + player.currentInning + '/' + gameState.options.baseballInnings;
                } else if (gameState.type === 'elimination') {
                    playerDiv.innerHTML += '<br>Score: ' + player.score;
                }
                if (index === gameState.currentPlayer) {
                    playerDiv.style.background = '#3a3a3a';
                }
                playersDiv.appendChild(playerDiv);
            });
        }

        function updateInputGrid() {
            var grid = document.getElementById('input-grid');
            grid.innerHTML = '';
            
            if (gameState.type === 'x01') {
                createX01InputGrid(grid);
            } else if (gameState.type === 'shooter' || gameState.type === 'shanghai' || gameState.type === 'clock' || gameState.type === '120') {
                createTargetInputGrid(grid);
            } else if (gameState.type === 'cricket') {
                createCricketInputGrid(grid);
            } else if (gameState.type === 'split') {
                createSplitInputGrid(grid);
            } else if (gameState.type === 'killer') {
                createKillerInputGrid(grid);
            } else if (gameState.type === 'golf') {
                createGolfInputGrid(grid);
            } else if (gameState.type === 'baseball') {
                createBaseballInputGrid(grid);
            } else if (gameState.type === 'elimination') {
                createEliminationInputGrid(grid);
            } else if (gameState.type === 'highscore') {
                createHighscoreInputGrid(grid);
            }
        }

        function createX01InputGrid(grid) {
            grid.className = 'input-grid x01-grid';
            for (var i = 1; i <= 20; i++) {
                var btn = createButton('target', i, 'Hit');
                btn.onclick = function(num) { return function() { handleX01NumberInput(num, 'target'); }; }(i);
                grid.appendChild(btn);
            }
            var innerBull = createButton('target', 'BULL', '25');
            innerBull.onclick = function() { handleX01NumberInput(25, 'target'); };
            grid.appendChild(innerBull);
            var outerBull = createButton('double', 'D-BULL', '50');
            outerBull.onclick = function() { handleX01NumberInput(25, 'double'); };
            grid.appendChild(outerBull);
            var doubleBtn = createButton('double', 'DOUBLE', 'x2');
            doubleBtn.onclick = function() { toggleX01Mode('double'); };
            grid.appendChild(doubleBtn);
            var tripleBtn = createButton('triple', 'TRIPLE', 'x3');
            tripleBtn.onclick = function() { toggleX01Mode('triple'); };
            grid.appendChild(tripleBtn);
            var missBtn = createButton('miss', 'MISS', '0');
            missBtn.onclick = function() { handleX01NumberInput(0, 'miss'); };
            grid.appendChild(missBtn);
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            undoBtn.onclick = function() { undoLastDart(); };
            grid.appendChild(undoBtn);
        }

        function toggleX01Mode(mode) {
            x01Mode = mode;
            var buttons = document.querySelectorAll('.input-button');
            buttons.forEach(function(btn) { btn.style.boxShadow = ''; });
            var modeBtn = document.querySelector('.input-button.' + mode);
            if (modeBtn) modeBtn.style.boxShadow = '0 0 15px rgba(255, 255, 255, 0.5)';
        }

        function createTargetInputGrid(grid) {
            grid.className = 'input-grid';
            var targetBtn = createButton('target', 'TARGET', 'Hit');
            var doubleBtn = createButton('double', 'DOUBLE', 'x2');
            var tripleBtn = createButton('triple', 'TRIPLE', 'x3');
            var missBtn = createButton('miss', 'MISS', gameState.options.shooterHalfScore || gameState.options.shanghaiHalfScore ? 'Half score' : '0');
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            [targetBtn, doubleBtn, tripleBtn, missBtn, undoBtn].forEach(btn => grid.appendChild(btn));
        }

        function createCricketInputGrid(grid) {
            grid.className = 'input-grid';
            for (var i = 15; i <= 20; i++) {
                var btn = createButton('target', i, 'Hit');
                btn.onclick = function(num) { return function() { hitCricketTarget(num, 1); }; }(i);
                grid.appendChild(btn);
            }
            var bullBtn = createButton('target', 'BULL', '25');
            bullBtn.onclick = function() { hitCricketTarget(25, 1); };
            grid.appendChild(bullBtn);
            var doubleBtn = createButton('double', 'DOUBLE', 'x2');
            doubleBtn.onclick = function() { hitCricketTarget(20, 2); };
            grid.appendChild(doubleBtn);
            var tripleBtn = createButton('triple', 'TRIPLE', 'x3');
            tripleBtn.onclick = function() { hitCricketTarget(20, 3); };
            grid.appendChild(tripleBtn);
            var missBtn = createButton('miss', 'MISS', '0');
            missBtn.onclick = function() { nextTurn(); };
            grid.appendChild(missBtn);
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            undoBtn.onclick = function() { undoLastDart(); };
            grid.appendChild(undoBtn);
        }

        function createSplitInputGrid(grid) {
            grid.className = 'input-grid';
            var targetBtn = createButton('target', 'HIT', 'Random');
            targetBtn.onclick = function() { handleSplitInput('target'); };
            var doubleBtn = createButton('double', 'DOUBLE', 'x2');
            doubleBtn.onclick = function() { handleSplitInput('double'); };
            var tripleBtn = createButton('triple', 'TRIPLE', 'x3');
            tripleBtn.onclick = function() { handleSplitInput('triple'); };
            var missBtn = createButton('miss', 'MISS', gameState.options.splitHalfScore ? 'Half score' : '0');
            missBtn.onclick = function() { handleSplitInput('miss'); };
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            undoBtn.onclick = function() { undoLastDart(); };
            [targetBtn, doubleBtn, tripleBtn, missBtn, undoBtn].forEach(btn => grid.appendChild(btn));
        }

        function createKillerInputGrid(grid) {
            grid.className = 'input-grid x01-grid';
            for (var i = 1; i <= 20; i++) {
                var btn = createButton('target', i, 'Hit');
                btn.onclick = function(num) { return function() { handleKillerInput(num); }; }(i);
                grid.appendChild(btn);
            }
            var bullBtn = createButton('target', 'BULL', '25');
            bullBtn.onclick = function() { handleKillerInput(25); };
            grid.appendChild(bullBtn);
            var missBtn = createButton('miss', 'MISS', '0');
            missBtn.onclick = function() { handleKillerInput(0); };
            grid.appendChild(missBtn);
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            undoBtn.onclick = function() { undoLastDart(); };
            grid.appendChild(undoBtn);
        }

        function createGolfInputGrid(grid) {
            grid.className = 'input-grid';
            var targetBtn = createButton('target', 'HOLE', 'Hit');
            var doubleBtn = createButton('double', 'DOUBLE', 'x2');
            var tripleBtn = createButton('triple', 'TRIPLE', 'x3');
            var missBtn = createButton('miss', 'MISS', '0');
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            var emptyBtn = createButton('', '', '');
            emptyBtn.style.opacity = '0.3';
            emptyBtn.style.pointerEvents = 'none';
            [targetBtn, doubleBtn, tripleBtn, missBtn, undoBtn, emptyBtn].forEach(btn => grid.appendChild(btn));
        }

        function createBaseballInputGrid(grid) {
            grid.className = 'input-grid';
            for (var i = 1; i <= 9; i++) {
                var btn = createButton('target', i, 'Inning ' + i);
                btn.onclick = function(num) { return function() { handleBaseballInput(num); }; }(i);
                grid.appendChild(btn);
            }
            var missBtn = createButton('miss', 'MISS', '0');
            missBtn.onclick = function() { handleBaseballInput(0); };
            grid.appendChild(missBtn);
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            undoBtn.onclick = function() { undoLastDart(); };
            grid.appendChild(undoBtn);
        }

        function createEliminationInputGrid(grid) {
            grid.className = 'input-grid x01-grid';
            for (var i = 1; i <= 20; i++) {
                var btn = createButton('target', i, 'Hit ' + i);
                btn.onclick = function(num) { return function() { handleEliminationInput(num); }; }(i);
                grid.appendChild(btn);
            }
            var bullBtn = createButton('target', 'BULL', '25');
            bullBtn.onclick = function() { handleEliminationInput(25); };
            grid.appendChild(bullBtn);
            var missBtn = createButton('miss', 'MISS', '0');
            missBtn.onclick = function() { handleEliminationInput(0); };
            grid.appendChild(missBtn);
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            undoBtn.onclick = function() { undoLastDart(); };
            grid.appendChild(undoBtn);
        }

        function createHighscoreInputGrid(grid) {
            grid.className = 'input-grid x01-grid';
            for (var i = 1; i <= 20; i++) {
                var btn = createButton('target', i, 'Hit ' + i);
                btn.onclick = function(num) { return function() { handleHighscoreInput(num); }; }(i);
                grid.appendChild(btn);
            }
            var bullBtn = createButton('target', 'BULL', '25');
            bullBtn.onclick = function() { handleHighscoreInput(25); };
            grid.appendChild(bullBtn);
            var missBtn = createButton('miss', 'MISS', '0');
            missBtn.onclick = function() { handleHighscoreInput(0); };
            grid.appendChild(missBtn);
            var undoBtn = createButton('undo', 'UNDO', 'Last dart');
            undoBtn.onclick = function() { undoLastDart(); };
            grid.appendChild(undoBtn);
        }

        function createButton(className, mainText, subText) {
            var btn = document.createElement('button');
            btn.className = 'input-button ' + className;
            btn.innerHTML = `<span class="button-main">${mainText}</span><span class="button-sub">${subText}</span>`;
            return btn;
        }

        function declareWinner(player, winType) {
            gameState.gameActive = false;
            document.getElementById('winner-name').textContent = player.name;
            document.getElementById('win-type').textContent = winType;
            document.getElementById('game-stats').innerHTML = generateGameStats();
            document.getElementById('winner-popup').style.display = 'flex';
        }

        function generateGameStats() {
            var stats = '<h3>Game Stats</h3><ul>';
            gameState.players.sort((a, b) => getPlayerStats(b).value - getPlayerStats(a).value).forEach(function(player) {
                var stat = getPlayerStats(player);
                stats += `<li>${player.name}: ${stat.label} - ${stat.value}</li>`;
            });
            stats += '</ul>';
            return stats;
        }

        function playAgain() {
            document.getElementById('winner-popup').style.display = 'none';
            setupGame(gameState.type);
        }

        function forceExit() {
            if (gameState.gameActive) {
                confirmExitGame();
            } else {
                showMainMenu();
            }
        }

        function confirmExitGame() {
            document.getElementById('exit-popup').style.display = 'flex';
        }

        function cancelExit() {
            document.getElementById('exit-popup').style.display = 'none';
        }

        function confirmExit() {
            document.getElementById('exit-popup').style.display = 'none';
            document.getElementById('winner-popup').style.display = 'none';
            showMainMenu();
            gameState = {
                type: '',
                options: {},
                players: [],
                currentPlayer: 0,
                currentDart: 1,
                currentRound: 1,
                gameActive: false,
                currentTarget: 1,
                targets: [],
                hasHitTarget: false
            };
        }

        function showGameRules() {
            var rules = getGameRules(gameState.type);
            alert(gameInfo[gameState.type].desc + '\n\n' + rules);
        }

        function getGameRules(type) {
            switch (type) {
                case 'x01':
                    return `Start with ${gameState.options.x01Score} points. Hit darts to reduce your score to zero. Must start with ${gameState.options.x01Start} and finish with ${gameState.options.x01Finish}.`;
                case 'shanghai':
                    return `Hit single, double, and triple of numbers ${gameState.options.shanghaiStart} to ${gameState.options.shanghaiEnd}. First to hit all three in one round or highest score wins.`;
                case 'cricket':
                    return 'Hit numbers 15-20 and Bull three times each to close them. First to close all with the highest score wins.';
                case 'shooter':
                    return `Hit ${gameState.options.shooterRounds} targets in order. Points based on hit type. Highest score wins.`;
                case 'clock':
                    return `Hit numbers in ${gameState.options.clockOrder} order (includes Bull: ${gameState.options.clockIncludeBull}). Complete all to win.`;
                case '120':
                    return `Hit numbers 1-20 in ${gameState.options.order120} order. Complete all to win.`;
                case 'killer':
                    return 'Each player gets a number. Hit others\' numbers to reduce their lives. Last player standing wins.';
                case 'golf':
                    return `Play ${gameState.options.golfHoles} holes. Lowest score wins, par based on number.`;
                case 'baseball':
                    return `Play ${gameState.options.baseballInnings} innings (1-9). Most runs wins.`;
                case 'elimination':
                    return `Play with ${gameState.options.eliminationDarts} darts per round. Lowest scorer is eliminated. Last player wins.`;
                case 'highscore':
                    return `Score as many points as possible with ${gameState.options.highscoreDarts} darts. Highest score wins.`;
                case 'split':
                    return 'Add up your score with each dart. Highest total wins.';
                default:
                    return 'Standard rules apply.';
            }
        }

        // Player Management
        function addPlayer() {
            var inputs = document.getElementById('player-inputs');
            var newInput = document.createElement('div');
            newInput.className = 'player-input';
            newInput.innerHTML = `<input type="text" placeholder="Player ${inputs.children.length + 2}"><button class="remove-player-btn" onclick="removePlayer(this)">-</button>`;
            inputs.appendChild(newInput);
            updateRemoveButtons();
        }

        function removePlayer(btn) {
            btn.parentElement.remove();
            updateRemoveButtons();
        }

        function updateRemoveButtons() {
            var inputs = document.getElementById('player-inputs').children;
            for (var i = 0; i < inputs.length; i++) {
                inputs[i].style.display = singlePlayerMode && i > 0 ? 'none' : 'flex';
                inputs[i].querySelector('input').placeholder = `Player ${i + 2}`;
            }
            if (inputs.length === 0 && !singlePlayerMode) {
                addPlayer();
            }
        }

        function createPlayer(name, gameType) {
            var player = {
                name: singlePlayerMode && name === 'Player 1' ? 'You' : name,
                score: gameType === 'x01' ? gameState.options.x01Score || 501 : 0,
                dartsThrown: 0,
                gameStarted: false,
                hits: { single: false, double: false, triple: false },
                currentNumber: gameState.options.shanghaiStart || 1,
                targets: [],
                currentTargetIndex: 0,
                completed: false,
                marks: { 15: 0, 16: 0, 17: 0, 18: 0, 19: 0, 20: 0, 25: 0 },
                killer: false,
                targetNumber: 0,
                lives: 3,
                holes: [],
                currentHole: 1,
                currentInning: 1,
                eliminated: false
            };
            if (gameType === 'killer') {
                player.targetNumber = Math.floor(Math.random() * 20) + 1;
            }
            return player;
        }

        function getPlayerStats(player) {
            if (gameState.type === 'x01') {
                return { label: 'Darts Thrown', value: player.dartsThrown };
            } else if (gameState.type === 'shooter' || gameState.type === 'shanghai' || gameState.type === 'split' || gameState.type === 'highscore') {
                return { label: 'Score', value: player.score };
            } else if (gameState.type === 'clock' || gameState.type === '120') {
                return { label: 'Progress', value: player.currentTargetIndex };
            } else if (gameState.type === 'cricket') {
                return { label: 'Score', value: player.score };
            } else if (gameState.type === 'killer') {
                return { label: 'Lives', value: player.lives };
            } else if (gameState.type === 'golf') {
                return { label: 'Total Score', value: player.score };
            } else if (gameState.type === 'baseball') {
                return { label: 'Runs', value: player.score };
            } else if (gameState.type === 'elimination') {
                return { label: 'Score', value: player.score };
            }
            return { label: 'N/A', value: 0 };
        }

        function getPlayerScore(player) {
            if (gameState.type === 'x01') {
                return player.score;
            } else if (gameState.type === 'shooter' || gameState.type === 'shanghai' || gameState.type === 'split' || gameState.type === 'highscore') {
                return player.score;
            } else if (gameState.type === 'cricket') {
                return player.score;
            } else if (gameState.type === 'killer') {
                return player.lives;
            } else if (gameState.type === 'golf') {
                return player.score;
            } else if (gameState.type === 'baseball') {
                return player.score;
            } else if (gameState.type === 'elimination') {
                return player.score;
            }
            return 0;
        }

        // Game Logic
        function startGame() {
            var playerInputs = document.querySelectorAll('.player-input input');
            var names = Array.from(playerInputs).map(input => input.value.trim());
            
            if (singlePlayerMode && names[0] === '') {
                alert('Please enter a player name.');
                return;
            }
            if (!singlePlayerMode && names.some(name => name === '')) {
                alert('All players must have a name.');
                return;
            }
            if (!singlePlayerMode && new Set(names).size !== names.length) {
                alert('Player names must be unique.');
                return;
            }
            
            var playerInputs = document.querySelectorAll('.player-input input');
            gameState.players = [];
            
            if (singlePlayerMode) {
                var name = playerInputs[0].value.trim() || 'You';
                gameState.players.push(createPlayer(name, gameState.type));
            } else {
                playerInputs.forEach(function(input, index) {
                    if (input.parentElement.style.display !== 'none') {
                        var name = input.value.trim() || 'Player ' + (index + 1);
                        gameState.players.push(createPlayer(name, gameState.type));
                    }
                });
            }

            if (gameState.type === 'x01') {
                gameState.options.x01Score = parseInt(document.getElementById('x01-score').value);
                gameState.options.x01Start = document.getElementById('x01-start').value;
                gameState.options.x01Finish = document.getElementById('x01-finish').value;
            } else if (gameState.type === 'shooter') {
                gameState.options.shooterRounds = parseInt(document.getElementById('shooter-rounds').value);
                gameState.options.shooterIncludeBull = document.getElementById('shooter-bull').checked;
                gameState.options.shooterHalfScore = document.getElementById('shooter-half').checked;
            } else if (gameState.type === 'shanghai') {
                gameState.options.shanghaiStart = parseInt(document.getElementById('shanghai-start').value);
                gameState.options.shanghaiEnd = parseInt(document.getElementById('shanghai-end').value);
                gameState.options.shanghaiHalfScore = document.getElementById('shanghai-half').checked;
            } else if (gameState.type === 'clock') {
                gameState.options.clockOrder = document.getElementById('clock-order').value;
                gameState.options.clockIncludeBull = document.getElementById('clock-bull').checked;
                gameState.options.clockQuickMode = document.getElementById('clock-quick').checked;
            } else if (gameState.type === '120') {
                gameState.options.order120 = document.getElementById('120-order').value;
            } else if (gameState.type === 'killer') {
                gameState.options.killerRandom = document.getElementById('killer-random').checked;
            } else if (gameState.type === 'golf') {
                gameState.options.golfHoles = parseInt(document.getElementById('golf-holes').value);
            } else if (gameState.type === 'baseball') {
                gameState.options.baseballInnings = parseInt(document.getElementById('baseball-innings').value);
            } else if (gameState.type === 'elimination') {
                gameState.options.eliminationDarts = parseInt(document.getElementById('elimination-darts').value);
            } else if (gameState.type === 'highscore') {
                gameState.options.highscoreDarts = parseInt(document.getElementById('highscore-darts').value);
            }

            initializeGame();
            
            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('game-interface').style.display = 'flex';
            
            gameState.gameActive = true;
            gameState.currentPlayer = 0;
            gameState.currentDart = 1;
            
            updateGameInterface();
        }

        function initializeGame() {
            if (gameState.type === 'shooter') {
                initializeShooterTargets();
            } else if (gameState.type === 'shanghai') {
                gameState.players.forEach(player => player.currentNumber = gameState.options.shanghaiStart);
            } else if (gameState.type === 'clock') {
                initializeClockTargets();
            } else if (gameState.type === '120') {
                initialize120Targets();
            } else if (gameState.type === 'killer') {
                assignKillerNumbers();
            }
        }

        function initializeShooterTargets() {
            gameState.targets = [];
            for (var i = 1; i <= gameState.options.shooterRounds; i++) {
                gameState.targets.push(i);
                if (gameState.options.shooterIncludeBull && i === gameState.options.shooterRounds) {
                    gameState.targets.push(25);
                }
            }
            gameState.currentTarget = gameState.targets[0];
        }

        function initializeClockTargets() {
            gameState.targets = [];
            if (gameState.options.clockOrder === 'asc') {
                for (var i = 1; i <= 20; i++) gameState.targets.push(i);
            } else if (gameState.options.clockOrder === 'desc') {
                for (var i = 20; i >= 1; i--) gameState.targets.push(i);
            } else {
                gameState.targets = Array.from({length: 20}, (_, i) => i + 1).sort(() => Math.random() - 0.5);
            }
            if (gameState.options.clockIncludeBull) gameState.targets.push(25);
            gameState.players.forEach(player => player.currentTargetIndex = 0);
        }

        function initialize120Targets() {
            gameState.targets = Array.from({length: 20}, (_, i) => i + 1);
            if (gameState.options.order120 === 'random') {
                gameState.targets.sort(() => Math.random() - 0.5);
            } else if (gameState.options.order120 === 'desc') {
                gameState.targets.reverse();
            }
            gameState.players.forEach(player => player.currentTargetIndex = 0);
        }

        function assignKillerNumbers() {
            var numbers = Array.from({length: 20}, (_, i) => i + 1);
            if (gameState.options.killerRandom) {
                numbers.sort(() => Math.random() - 0.5);
            }
            gameState.players.forEach(player => {
                player.targetNumber = numbers.pop();
                player.lives = 3;
            });
        }

        function nextTurn() {
            if (gameState.currentDart === 3) {
                gameState.currentDart = 1;
                gameState.currentPlayer = (gameState.currentPlayer + 1) % gameState.players.length;
                if (gameState.currentPlayer === 0) {
                    gameState.currentRound++;
                }
                if (gameState.type === 'shooter' && gameState.hasHitTarget) {
                    nextShooterRound();
                } else if (gameState.type === 'shanghai') {
                    nextShanghaiRound();
                }
            } else {
                gameState.currentDart++;
            }
            updateGameInterface();
        }

        function nextShooterRound() {
            var index = gameState.targets.indexOf(gameState.currentTarget) + 1;
            if (index < gameState.targets.length) {
                gameState.currentTarget = gameState.targets[index];
                gameState.hasHitTarget = false;
            } else {
                var winner = gameState.players.reduce((max, p) => p.score > max.score ? p : max);
                declareWinner(winner, 'SHOOTER!');
            }
        }

        function nextShanghaiRound() {
            var player = gameState.players[gameState.currentPlayer];
            if (player.currentNumber < gameState.options.shanghaiEnd) {
                player.currentNumber++;
                player.hits = { single: false, double: false, triple: false };
            } else {
                var winner = gameState.players.reduce((max, p) => p.score > max.score ? p : max);
                declareWinner(winner, 'SHANGHAI!');
            }
        }

        function undoLastDart() {
            if (!gameState.gameActive || actionHistory.length === 0) return;
            
            var lastAction = actionHistory.pop();
            var player = gameState.players[lastAction.playerIndex];
            
            if (lastAction.type === 'x01-score') {
                player.score = lastAction.previousScore;
                player.dartsThrown--;
            } else if (lastAction.type === 'shanghai-hit') {
                player.score = lastAction.previousScore;
                player.hits = lastAction.previousHits;
                player.dartsThrown--;
            } else if (lastAction.type === 'shooter-hit') {
                player.score = lastAction.previousScore;
                player.targets.pop();
                player.dartsThrown--;
            } else if (lastAction.type === 'clock-progress') {
                player.currentTargetIndex = lastAction.previousIndex;
                player.dartsThrown--;
            } else if (lastAction.type === 'split-score') {
                player.score = lastAction.previousScore;
                player.dartsThrown--;
            } else if (lastAction.type === 'cricket-mark') {
                player.marks[lastAction.target] -= lastAction.multiplier;
                player.score = lastAction.previousScore;
                player.dartsThrown--;
            } else if (lastAction.type === 'killer-hit') {
                gameState.players.forEach((p, i) => p.lives = lastAction.previousLives[i]);
                player.dartsThrown--;
            } else if (lastAction.type === 'golf-score') {
                player.score = lastAction.previousScore;
                player.dartsThrown--;
            } else if (lastAction.type === 'baseball-run') {
                player.score = lastAction.previousScore;
                player.dartsThrown--;
            } else if (lastAction.type === 'elimination-score') {
                player.score = lastAction.previousScore;
                player.dartsThrown--;
            } else if (lastAction.type === 'highscore-score') {
                player.score = lastAction.previousScore;
                player.dartsThrown--;
            }

            if (gameState.currentDart > 1) {
                gameState.currentDart--;
            } else {
                gameState.currentPlayer = lastAction.playerIndex;
                gameState.currentDart = 3;
                if (gameState.currentPlayer === 0 && gameState.currentRound > 1) {
                    gameState.currentRound--;
                }
            }
            
            updateGameInterface();
        }

        function handleX01NumberInput(number, type) {
            var player = gameState.players[gameState.currentPlayer];
            var multiplier = x01Mode === 'double' ? 2 : x01Mode === 'triple' ? 3 : 1;
            var finalType = type === 'miss' ? 'miss' : x01Mode;
            
            if (number === 25) {
                multiplier = type === 'double' ? 2 : 1;
                finalType = type;
            }
            
            var points = number * multiplier;
            var action = {
                type: 'x01-score',
                playerIndex: gameState.currentPlayer,
                previousScore: player.score
            };

            if (!player.gameStarted && finalType !== 'miss') {
                var canStart = true;
                if (gameState.options.x01Start === 'double' && finalType !== 'double') {
                    canStart = false;
                } else if (gameState.options.x01Start === 'master' && finalType !== 'double' && finalType !== 'triple') {
                    canStart = false;
                }
                
                if (canStart) {
                    player.gameStarted = true;
                } else {
                    player.dartsThrown++;
                    x01Mode = 'single';
                    nextTurn();
                    return;
                }
            }
            
            if (finalType !== 'miss' && player.gameStarted) {
                if (player.score - points >= 0) {
                    if (player.score - points === 0) {
                        var canFinish = true;
                        if (gameState.options.x01Finish === 'double' && finalType !== 'double') {
                            canFinish = false;
                        } else if (gameState.options.x01Finish === 'master' && finalType !== 'double' && finalType !== 'triple') {
                            canFinish = false;
                        }
                        
                        if (canFinish) {
                            player.score = 0;
                            actionHistory = []; // Clear history on game end
                            x01Mode = 'single';
                            declareWinner(player, 'CHECKOUT!');
                            return;
                        }
                    } else {
                        player.score -= points;
                        recordAction(action);
                    }
                }
            }
            
            player.dartsThrown++;
            x01Mode = 'single';
            nextTurn();
        }

        function handleShooterInput(type, player) {
            var currentTarget = gameState.currentTarget;
            var points = 0;
            var hit = false;
            var action = {
                type: 'shooter-hit',
                playerIndex: gameState.currentPlayer,
                previousScore: player.score
            };
            
            if (type === 'target') {
                points = currentTarget;
                hit = true;
            } else if (type === 'double' && currentTarget !== 25) {
                points = currentTarget * 2;
                hit = true;
            } else if (type === 'triple' && currentTarget !== 25) {
                points = currentTarget * 3;
                hit = true;
            } else if (type === 'double' && currentTarget === 25) {
                points = 50;
                hit = true;
            }
            
            if (hit) {
                player.score += points;
                player.targets.push({target: currentTarget, points: points});
                gameState.hasHitTarget = true;
                recordAction(action);
            } else if (type === 'miss' && gameState.options.shooterHalfScore) {
                player.score = Math.floor(player.score / 2);
            }
            
            player.dartsThrown++;
            return hit;
        }

        function handleShanghaiInput(type, player) {
            var currentNumber = player.currentNumber;
            var points = 0;
            var hit = false;
            var action = {
                type: 'shanghai-hit',
                playerIndex: gameState.currentPlayer,
                previousScore: player.score,
                previousHits: {...player.hits}
            };
            
            if (type === 'target') {
                points = currentNumber;
                hit = true;
                if (!player.hits.single) player.hits.single = true;
            } else if (type === 'double') {
                points = currentNumber === 25 ? 50 : currentNumber * 2;
                hit = true;
                if (!player.hits.double) player.hits.double = true;
            } else if (type === 'triple' && currentNumber !== 25) {
                points = currentNumber * 3;
                hit = true;
                if (!player.hits.triple) player.hits.triple = true;
            } else if (type === 'miss' && gameState.options.shanghaiHalfScore) {
                player.score = Math.max(0, Math.floor(player.score / 2));
            }
            
            if (hit) {
                player.score += points;
                recordAction(action);
            }
            
            if (player.hits.single && player.hits.double && (player.hits.triple || currentNumber === 25)) {
                declareWinner(player, 'SHANGHAI!');
                return hit;
            }
            
            player.dartsThrown++;
            return hit;
        }

        function handleClockInput(type, player) {
            var currentTarget = gameState.targets[player.currentTargetIndex];
            var hit = false;
            var skipCount = 0;
            var action = {
                type: 'clock-progress',
                playerIndex: gameState.currentPlayer,
                previousIndex: player.currentTargetIndex
            };
            
            if ((type === 'target' || type === 'double' || type === 'triple') && 
                (currentTarget !== 25 || type !== 'triple')) {
                hit = true;
                if (gameState.options.clockQuickMode) {
                    skipCount = type === 'double' ? 2 : type === 'triple' ? 3 : 1;
                } else {
                    skipCount = 1;
                }
                player.currentTargetIndex += skipCount;
                recordAction(action);
                
                if (player.currentTargetIndex >= gameState.targets.length) {
                    player.completed = true;
                    declareWinner(player, 'COMPLETED!');
                    return hit;
                }
            }
            
            player.dartsThrown++;
            return hit;
        }

        function handleSplitInput(type, player) {
            var action = {
                type: 'split-score',
                playerIndex: gameState.currentPlayer,
                previousScore: player.score
            };
            if (type === 'miss') {
                if (gameState.options.splitHalfScore) {
                    player.score = Math.max(0, Math.floor(player.score / 2));
                }
            } else {
                var randomScore = Math.floor(Math.random() * 20) + 1;
                var multiplier = type === 'double' ? 2 : type === 'triple' ? 3 : 1;
                player.score += randomScore * multiplier;
                recordAction(action);
            }
            player.dartsThrown++;
        }

        function handleKillerInput(number) {
            var player = gameState.players[gameState.currentPlayer];
            var action = {
                type: 'killer-hit',
                playerIndex: gameState.currentPlayer,
                previousLives: [...gameState.players.map(p => p.lives)]
            };
            if (!player.killer) {
                if (number === player.targetNumber) {
                    player.killer = true;
                }
            } else {
                gameState.players.forEach(function(opponent, index) {
                    if (index !== gameState.currentPlayer && opponent.targetNumber === number && opponent.lives > 0) {
                        opponent.lives--;
                        if (opponent.lives <= 0) {
                            opponent.eliminated = true;
                        }
                    }
                });
                var activePlayers = gameState.players.filter(p => !p.eliminated);
                if (activePlayers.length === 1) {
                    declareWinner(activePlayers[0], 'LAST PLAYER STANDING!');
                    return;
                }
            }
            recordAction(action);
            player.dartsThrown++;
            nextTurn();
        }

        function handleGolfInput(type) {
            var player = gameState.players[gameState.currentPlayer];
            var action = {
                type: 'golf-score',
                playerIndex: gameState.currentPlayer,
                previousScore: player.score
            };
            var score = player.currentHole;
            var multiplier = type === 'double' ? 2 : type === 'triple' ? 3 : 1;
            player.score += score * multiplier;
            if (type === 'miss') player.score += 2; // Penalty for miss
            recordAction(action);
            player.dartsThrown++;
            if (player.dartsThrown % 3 === 0) {
                player.holes.push(player.score);
                player.currentHole++;
                if (player.currentHole > gameState.options.golfHoles) {
                    var winner = gameState.players.reduce((min, p) => p.score < min.score ? p : min);
                    declareWinner(winner, 'LOWEST SCORE!');
                }
            }
            nextTurn();
        }

        function handleBaseballInput(inning) {
            var player = gameState.players[gameState.currentPlayer];
            var action = {
                type: 'baseball-run',
                playerIndex: gameState.currentPlayer,
                previousScore: player.score
            };
            if (inning === player.currentInning) {
                player.score += 1; // Score a run
                recordAction(action);
            } else if (inning === 0) {
                // Miss, no action
            }
            player.dartsThrown++;
            if (player.dartsThrown % 3 === 0) {
                player.currentInning++;
                if (player.currentInning > gameState.options.baseballInnings) {
                    var winner = gameState.players.reduce((max, p) => p.score > max.score ? p : max);
                    declareWinner(winner, 'MOST RUNS!');
                }
            }
            nextTurn();
        }

        function handleEliminationInput(score) {
            var player = gameState.players[gameState.currentPlayer];
            var action = {
                type: 'elimination-score',
                playerIndex: gameState.currentPlayer,
                previousScore: player.score
            };
            player.score += score;
            recordAction(action);
            player.dartsThrown++;
            if (player.dartsThrown % gameState.options.eliminationDarts === 0) {
                var minScore = Math.min(...gameState.players.map(p => p.score));
                var lowestPlayers = gameState.players.filter(p => p.score === minScore);
                if (lowestPlayers.length === 1 && lowestPlayers[0].score === 0) {
                    var winner = gameState.players.find(p => p !== lowestPlayers[0]);
                    declareWinner(winner, 'LAST STANDING!');
                } else {
                    lowestPlayers.forEach(p => p.eliminated = true);
                    gameState.players = gameState.players.filter(p => !p.eliminated);
                    if (gameState.players.length === 1) {
                        declareWinner(gameState.players[0], 'WINNER!');
                    }
                }
                gameState.players.forEach(p => p.score = 0);
            }
            nextTurn();
        }

        function handleHighscoreInput(score) {
            var player = gameState.players[gameState.currentPlayer];
            var action = {
                type: 'highscore-score',
                playerIndex: gameState.currentPlayer,
                previousScore: player.score
            };
            player.score += score;
            recordAction(action);
            player.dartsThrown++;
            if (player.dartsThrown >= gameState.options.highscoreDarts) {
                var winner = gameState.players.reduce((max, p) => p.score > max.score ? p : max);
                declareWinner(winner, 'HIGHEST SCORE!');
            }
            nextTurn();
        }

        function hitCricketTarget(target, multiplier) {
            var player = gameState.players[gameState.currentPlayer];
            var action = {
                type: 'cricket-mark',
                playerIndex: gameState.currentPlayer,
                target: target,
                multiplier: multiplier,
                previousScore: player.score,
                previousMarks: {...player.marks}
            };
            player.marks[target] += multiplier;
            
            if (player.marks[target] > 3) {
                var allOpponentsClosed = gameState.players.every(function(p, index) {
                    return index === gameState.currentPlayer || p.marks[target] >= 3;
                });
                if (!allOpponentsClosed) {
                    var extraMarks = player.marks[target] - 3;
                    player.score += target * extraMarks;
                }
                player.marks[target] = 3;
            }
            
            var allClosed = Object.values(player.marks).every(function(marks) {
                return marks >= 3;
            });
            if (allClosed) {
                var hasHighestScore = gameState.players.every(function(p, index) {
                    return index === gameState.currentPlayer || p.score <= player.score;
                });
                if (hasHighestScore) {
                    declareWinner(player, 'CRICKET!');
                    return;
                }
            }
            
            recordAction(action);
            player.dartsThrown++;
            nextTurn();
        }

        function recordAction(action) {
            actionHistory.push(action);
        }

        function toggleShooterBull() {
            gameState.options.shooterIncludeBull = document.getElementById('shooter-bull').checked;
        }

        function toggleShooterHalf() {
            gameState.options.shooterHalfScore = document.getElementById('shooter-half').checked;
        }

        function toggleClockBull() {
            gameState.options.clockIncludeBull = document.getElementById('clock-bull').checked;
        }

        function toggleHalfScore() {
            gameState.options.splitHalfScore = document.getElementById('split-half').checked;
        }

        function toggleClockQuick() {
            gameState.options.clockQuickMode = document.getElementById('clock-quick').checked;
        }

        function toggleShanghaiHalf() {
            gameState.options.shanghaiHalfScore = document.getElementById('shanghai-half').checked;
        }

        function toggleSinglePlayer() {
            singlePlayerMode = document.getElementById('single-player-toggle').checked;
            updateRemoveButtons();
        }

        function toggleKillerRandom() {
            gameState.options.killerRandom = document.getElementById('killer-random').checked;
        }

        // Initialization
        document.addEventListener('DOMContentLoaded', function() {
            showMainMenu();
            updateRemoveButtons();
        });
        showMainMenu();

        document.querySelectorAll('.menu-card, .input-button, .back-btn, .help-btn').forEach(button => {
            button.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    button.click();
                }
            });
        });

        function handleInput(type, value) {
            if (!gameState.gameActive) return;
            
            if (type === 'undo') {
                undoLastDart();
                return;
            }
            
            var player = gameState.players[gameState.currentPlayer];
            if (gameState.type === 'x01') {
                handleX01NumberInput(parseInt(value) || 25, type);
            } else if (gameState.type === 'shooter') {
                handleShooterInput(type, player);
            } else if (gameState.type === 'shanghai') {
                handleShanghaiInput(type, player);
            } else if (gameState.type === 'clock' || gameState.type === '120') {
                handleClockInput(type, player);
            } else if (gameState.type === 'cricket') {
                hitCricketTarget(parseInt(value) || 25, type === 'double' ? 2 : type === 'triple' ? 3 : 1);
            } else if (gameState.type === 'split') {
                handleSplitInput(type, player);
            } else if (gameState.type === 'killer') {
                handleKillerInput(parseInt(value) || 0);
            } else if (gameState.type === 'golf') {
                handleGolfInput(type);
            } else if (gameState.type === 'baseball') {
                handleBaseballInput(parseInt(value) || 0);
            } else if (gameState.type === 'elimination') {
                handleEliminationInput(parseInt(value) || 0);
            } else if (gameState.type === 'highscore') {
                handleHighscoreInput(parseInt(value) || 0);
            }
        }

        document.querySelectorAll('.input-button').forEach(button => {
            button.addEventListener('click', function() {
                var className = this.className.split(' ')[1];
                var value = this.querySelector('.button-main').textContent;
                handleInput(className, value);
            });
        });
    </script>
</body>
</html>
Integration Instructions
Copy and Replace:
Copy the entire code block above into a new file named index.html.
Save it in the same directory as your original jamie-tech-prints-logo.png file (
